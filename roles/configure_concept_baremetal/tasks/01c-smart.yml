---
- name: Install packages
  ansible.builtin.apt:
    install_recommends: false
    pkg:
      - nvme-cli
      - lm-sensors
    state: present

- name: Install some hdd related packages
  ansible.builtin.apt:
    install_recommends: false
    pkg:
      - hdparm
      - smartmontools
      - rsync
      - libatasmart-bin
    state: present
  when: ansible_pkg_mgr == 'apt'

- name: Install some hdd related packages
  ansible.builtin.dnf:
    pkg:
      - hdparm
      - smartmontools
      - rsync
      - libatasmart-bin
    state: present
  when: ansible_pkg_mgr == 'dnf'

- name: Copy SMART check script
  ansible.builtin.copy:
    src: files/checksmart.sh
    dest: /root/checksmart.sh
    mode: "0700"
