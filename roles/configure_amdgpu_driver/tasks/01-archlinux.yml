---
# https://wiki.archlinux.org/title/AMDGPU

- name: Install amdgpu driver
  ansible.builtin.package:
    name:
      - mesa
      - vulkan-radeon
      - libva-mesa-driver
      - mesa-vdpau
      - rocm-hip-sdk
      - rocm-opencl-sdk
      - rocm-language-runtime
      - rocm-opencl-runtime
    state: present
  notify:
    - AMD config tool

- name: Symlink rocm-smi to /usr/local/bin
  ansible.builtin.file:
    src: /opt/rocm/bin/rocm-smi
    dest: /usr/local/bin/rocm-smi
    state: link
