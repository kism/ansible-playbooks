---
- name: Include vars from fileglob
  ansible.builtin.include_vars: "vars/*.yml"

- name: Include tasks for package manager, assumes that apt and dnf are servers
  ansible.builtin.include_tasks: "01-{{ ansible_pkg_mgr }}.yml"

- name: Include tasks for baremetal hosts
  when: ansible_facts['virtualization_role'] == 'host'
  ansible.builtin.include_tasks: "02-{{ ansible_pkg_mgr }}-baremetal.yml"

- name: Block for fastfetch/neofetch so I don't want both
  block:
    - name: Install fastfetch
      ansible.builtin.package:
        name: fastfetch
        state: present

    - name: Remove neofetch
      ansible.builtin.package:
        name: neofetch
        state: absent

  rescue:
    - name: Remove neofetch
      ansible.builtin.package:
        name: neofetch
        state: present
