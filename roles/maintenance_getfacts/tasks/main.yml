---
- name: Gather facts
  ansible.builtin.setup:

- name: Set debug mode
  ansible.builtin.set_fact:
    maintenance_getfacts_print_debug: "{{ print_debug }}"
  when: print_debug is defined

- name: Print facts
  ansible.builtin.debug:
    msg: "{{ ansible_facts }}"
  when: maintenance_getfacts_print_debug

- name: Get user info
  ansible.builtin.getent:
    database: passwd

- name: Print user facts
  ansible.builtin.debug:
    msg: "{{ ansible_facts.getent_passwd }}"
  when: maintenance_getfacts_print_debug

- name: Get group info
  ansible.builtin.getent:
    database: group

- name: Print group facts
  ansible.builtin.debug:
    msg: "{{ ansible_facts.getent_group }}"
  when: maintenance_getfacts_print_debug
