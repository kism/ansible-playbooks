---
- name: Setup testnas samba host
  hosts: testnas
  gather_facts: false
  become: true
  roles:
    # Preflight
    - meta_include_secrets
    - maintenance_gather_proxmox_guests
    - create_proxmox_ct
    - maintenance_gather_facts

    # Onboard Server
    # - meta_onboard_server

    # Purpose specific
    - configure_jellyfin_adhoc
    # - configure_jellyfin_from_package

    # End
    # - configure_telegraf
    - maintenance_print_reminders



# # testnas
# chmod a+rwX /var/lib/jellyfin
# chmod -R a+rwX /var/lib/jellyfin/data/
# systemctl stop jellyfin

# # Code
# mkdir -p /tmp/jellyfin/data
# rsync kismnas:/opt/jellyfin/data/data/jellyfin.db      /tmp/jellyfin/data
# rsync kismnas:/opt/jellyfin/data/data/jellyfin.db-shm  /tmp/jellyfin/data
# rsync kismnas:/opt/jellyfin/data/data/jellyfin.db-wal  /tmp/jellyfin/data
# rsync kismnas:/opt/jellyfin/data/data/library.db       /tmp/jellyfin/data
# rsync kismnas:/opt/jellyfin/data/data/library.db-shm   /tmp/jellyfin/data
# rsync kismnas:/opt/jellyfin/data/data/library.db-wal   /tmp/jellyfin/data


# rsync /tmp/jellyfin/data/jellyfin.db      testnas:/var/lib/jellyfin/data/
# rsync /tmp/jellyfin/data/jellyfin.db-shm  testnas:/var/lib/jellyfin/data/
# rsync /tmp/jellyfin/data/jellyfin.db-wal  testnas:/var/lib/jellyfin/data/
# rsync /tmp/jellyfin/data/library.db       testnas:/var/lib/jellyfin/data/
# rsync /tmp/jellyfin/data/library.db-shm   testnas:/var/lib/jellyfin/data/
# rsync /tmp/jellyfin/data/library.db-wal   testnas:/var/lib/jellyfin/data/


# # testnas
# systemctl start jellyfin

